{% extends "default_layout.html" %}

{% block js %}
<script type="text/javascript" src="{{ STATIC_URL }}js/homeroom.js"></script>
{% endblock %}

{% block content %}

{% if messages %}
    <div class="alert alert-success">
        {% for msg in messages %}
            {{ msg }}
        {% endfor %}
    </div>
{% endif %}

<!-- Invite Users Modal -->
<div class="modal hide" id="invite-users">
	<div class="modal-header">
		<a class="close" data-dismiss="modal">Ã—</a>
		<h3>Invite Users</h3>
	</div>

	<div class="modal-body">
		<h6>Share this URL to invite users to your Class:</h6>
		<p>			 
			<span id="#invite-url">http://knetwork.org/invite#2342</span>
			(<a href=#copy-to-clipboard> Copy URL </a>)
		</p>
	
		<!-- TO-DO: notify K Network Users internally and via E-Mail
		<div class="well">
			<h4>Invite K Network Users</h4>
		</div>
	
		<div class="well">
			<h4>Let us e-mail invites for you!</h4>
		</div>
		-->
	</div>

	<div class="modal-footer">
		<a href="#" data-dismiss="modal" class="btn">Close</a>
	</div>
</div>

<!-- Bread Crumb Navigation -->
<section id="breadcrumbs">
	<div id="breadcrumbs span12">
		<ul class="breadcrumb">
			<li>
				<a href="#"><i class="icon-home"></i> Homeroom</a>
			</li>
		</ul>
	</div>
</section>

<section id="school">
	
	<h3>My School: <small>{{ main_school }}</small></h3> 
	
	<div class="school-actions">
		{% if main_school %}	
		<div class="create-class" class="btn btn-primary pull-left">Create Class</div>
		{% endif %}
		<div class="span2">
			<div id="class-filter">
				<form class="form-vertical pull-left">
					<fieldset>
						<div class="control-group"> 
							<div class="controls">
								<select id="class-filter" class="span3">	
									<option>Show All Classes</option>
									<option>Show My Classes</option>
								</select>
							</div>
						</div>
					</fieldset>
				</form>
			</div>
		</div>
	</div>


	<div id="class-list">
		<div class="row">
			<div class="span12">
				<table class="table table-striped table-condensed">
					<thead>
						<tr>
							<th>Class Name</th>
							<th>Info</th>
							<th>Actions</th>	
							<th></th>
						</tr>
					</thead>
			
					<tbody>
						<tr>
						{# Show Create Class Alert if there are no classes #}	
						{% if main_school == none %}
							<td>
								<div id="new-user-prompt" class="alert alert-info span4">
									<a class="create-class" href="/schools/{{ main_school.id }}/create_a_class">Create a Class</a> 
									and invite users {% if classes %}, or request to join a class listed below {% endif %} to get started
						
								</div>
							</td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
						{% endif %}

						{# Inline form to create a class #}
						<tr id="create-class-row" class="hide">
							<form id="addClassroomForm" action="/schools/{{main_school.id}}/create_a_class" method="post">{% csrf_token %}
								<td>
									<i class="icon-book"></i>
										<input id="id_class_name" name="class_name" type="text" placeholder="Class Name"></input>
										<button id="" name="cancel-class-creation" type="" class="btn btn-danger">Cancel</button>
										<button id="submit" name="submit" type="submit" class="btn btn-success">Confirm</button>
									</td>
								<td></td>
								<td></td>
								<td></td>
							</form>
						</tr>
						{# loop through current classes #}	
						{% for classroom in main_school.classrooms.all %}
						<tr>
							<td><a href='/schools/{{main_school.id}}/{{ classroom.id }}'><i class="icon-book"></i> {{classroom}}</a></td>
							<td><a href=''
									rel="users"
									data-original-title="Users in this Class" 
									data-content="{{ classroom.id }}"
									data-placement="left">	
								<i class="icon-user"></i> {{classroom.user_set.all.count}} Users</a></td>
							<td><a href="#invite-users" data-toggle="modal"><i class="icon-plus-sign"></i> Invite Users</a></td>
							<td><a href=#pending-invites>{{ classroom.invitations.count }} Pending Invites</a></td>
						</tr>
						{% endfor %}
					</tbody>	
				</table>
			</div>
		<div>
	</div>
</section>


{% endblock %}
